<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="FitApp.WorkoutListPage"
             xmlns:local="clr-namespace:FitApp.ViewModels"
             Title="Ð¡Ð¿Ð¸ÑÐ¾Ðº Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²Ð¾Ðº"
             >
    <VerticalStackLayout>
        <Entry Placeholder = "Ð²Ð²ÐµÐ´Ð¸ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸" Text="{Binding WorkoutName, Mode=TwoWay}"></Entry>

        <Border Padding="15" 
        BackgroundColor="{AppThemeBinding Light=#E3F2FD, Dark=#1E3A5F}"
        StrokeThickness="0"
        Margin="0,20,0,15">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="10"/>
            </Border.StrokeShape>

            <Grid ColumnDefinitions="*,*,Auto" ColumnSpacing="10">
                <!-- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð´Ð°Ñ‚Ðµ -->
                <DatePicker Grid.Column="0"
                    Date="{Binding FilterDate, Mode=TwoWay}" 
                    Format="d"
                    MinimumDate="1/1/2020"
                    MaximumDate="1/1/2030"/>

                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð° -->
                <Button Grid.Column="1" 
                Text="ðŸ”" 
                Command="{Binding FilterByDateCommand}"
                BackgroundColor="#2196F3"
                TextColor="White"
                WidthRequest="60"
                HeightRequest="45"/>

                <!-- ðŸ”¥ ÐÐžÐ’ÐÐ¯ ÐšÐÐžÐŸÐšÐ "ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ" -->
                <Button Grid.Column="2" 
                Text="ðŸ“‹ Ð’ÑÐµ" 
                Command="{Binding ShowAllWorkoutsCommand}"
                BackgroundColor="#4CAF50"
                TextColor="White"
                WidthRequest="70"
                HeightRequest="45"/>
            </Grid>
        </Border>

        <Label x:Name="labelTime" Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´Ð°Ñ‚Ñƒ"/>
        <DatePicker x:Name="WorkoutDatePicker" Date="{Binding SelectedDate, Mode=TwoWay}" Format="d">
            <DatePicker.MinimumDate>1/1/2010</DatePicker.MinimumDate>
            <DatePicker.MaximumDate>1/1/2030</DatePicker.MaximumDate>
        </DatePicker>
        <Label Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð²Ñ€ÐµÐ¼Ñ"/>
        <TimePicker Time="{Binding SelectedTime, Mode=TwoWay}"/>

        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð° Ð¿Ð¾ Ð³Ñ€ÑƒÐ¿Ð¿Ðµ Ð¼Ñ‹Ñ‰Ñ† -->
        <Label Text="Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð³Ñ€ÑƒÐ¿Ð¿Ðµ Ð¼Ñ‹ÑˆÑ†" FontAttributes="Bold"/>

        <Picker Title="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð³Ñ€ÑƒÐ¿Ð¿Ñƒ Ð¼Ñ‹ÑˆÑ†"
        ItemsSource="{Binding AllMuscleGroups}"
        ItemDisplayBinding="{Binding Name}"
        SelectedItem="{Binding SelectedFilterMuscleGroup, Mode=TwoWay}" />

        <HorizontalStackLayout Spacing="10">
            <Button Text="Ð¤Ð¸Ð»ÑŒÑ‚Ñ€"
            Command="{Binding FilterByMuscleGroupCommand}" />
            <Button Text="Ð¡Ð±Ñ€Ð¾Ñ"
            Command="{Binding ShowAllWorkoutsCommand}" />
        </HorizontalStackLayout>

        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸-->
        <Button Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÑƒ" Command="{Binding AddWorkoutCommand}"></Button>
        
        <StackLayout Orientation="Vertical" >
            <CollectionView ItemsSource="{Binding FilteredWorkouts}" 
                            SelectionMode="Single" 
                            SelectionChanged="OnWorkoutSelected"
                            BackgroundColor="Gray"
                            x:Name="WorkoutCollectionView"
                            
                            >
                <CollectionView.ItemTemplate >
                    <DataTemplate >
                        <StackLayout Orientation="Horizontal" Padding ="15" >
                            
                            <Label Text="{Binding Name}" FontAttributes="Bold" FontSize="18" VerticalOptions="Center"/>
                            <Label Text="{Binding StartTime}" TextColor="Black" VerticalOptions="Center" Padding ="5"/>
                            <Button Text="X" 
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type local:WorkoutViewModel}},Path=DeleteWorkoutCommand}" 
                                    CommandParameter="{Binding .}"></Button>
                        </StackLayout>

                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </StackLayout>
        
        
    </VerticalStackLayout>
</ContentPage>