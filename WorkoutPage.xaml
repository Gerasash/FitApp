<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="FitApp.WorkoutPage"
             xmlns:local="clr-namespace:FitApp.ViewModels"
             >
    <ScrollView>
        
    
    <VerticalStackLayout Padding="20" Spacing="20">
        <Editor Text="{Binding WorkoutName, Mode=TwoWay}" FontSize="26" TextColor="Orange">
            
        </Editor>
        <Button Text="Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð½Ð°Ð·Ð°Ð´" BorderColor="Red"  Clicked="OnBackButtonClicked" Command="{Binding LoadWorkoutsCommand}"></Button>
        <Label x:Name="WorkoutNameLabel" Text="Ð”ÐµÑ‚Ð°Ð»Ð¸ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸"  FontSize="Large"/>

        <Button x:Name ="addExerciseButton"  Text = " âž• Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑƒÐ¿Ñ€Ð°Ð¶Ð½ÐµÐ½Ð¸Ðµ" HorizontalOptions="Start"/>
        <!-- ðŸ”¥ Ð¡ÐŸÐ˜Ð¡ÐžÐš Ð£ÐŸÐ ÐÐ–ÐÐ•ÐÐ˜Ð™ Ð¢Ð Ð•ÐÐ˜Ð ÐžÐ’ÐšÐ˜ -->
        <Label Text="Ð£Ð¿Ñ€Ð°Ð¶Ð½ÐµÐ½Ð¸Ñ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸:" 
               FontSize="18" 
               FontAttributes="Bold"
               Margin="0,20,0,10"/>

        <CollectionView ItemsSource="{Binding WorkoutExercises}"
                        HeightRequest="300">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border BackgroundColor="LightBlue" 
                           Padding="15" 
                           Margin="5" 
                           >
                        <VerticalStackLayout Spacing="5">
                            <Label Text="{Binding ExerciseName}" 
                                   FontSize="18" 
                                   FontAttributes="Bold"/>
                            <Label Text="{Binding OrderIndex, StringFormat='ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº: {0}'}" 
                                   FontSize="14" 
                                   TextColor="Gray"/>
                            <Button Text="âž• ÐŸÐ¾Ð´Ñ…Ð¾Ð´"
                                   Command="{Binding Source={RelativeSource AncestorType={x:Type local:WorkoutViewModel}}, Path=AddSetCommand}"
                                   CommandParameter="{Binding .}"
                                   HorizontalOptions="Start"/>


                                <!-- ÐŸÐ¾Ð´Ñ…Ð¾Ð´Ñ‹ (Sets) -->
                            <CollectionView ItemsSource="{Binding Sets}">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <HorizontalStackLayout Spacing="10">
                                            <Label Text="{Binding SetNumber, StringFormat='#{0}'}"/>
                                            <Label Text="{Binding Weight, StringFormat='{0} ÐºÐ³'}"/>
                                            <Label Text="{Binding Reps, StringFormat='{0} Ð¿Ð¾Ð²Ñ‚'}"/>
                                            <Label Text="{Binding RPE, StringFormat='RPE {0}'}"/>
                                        </HorizontalStackLayout>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Label  Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹ Ð¼Ñ‹ÑˆÑ†" 
                Margin="0,10,0,5"
                TextColor="{AppThemeBinding Light=Black, Dark=White}"
                FontAttributes="Bold" 
                FontSize="18"/>

        <CollectionView ItemsSource="{Binding AllMuscleGroups}"
                SelectionMode="Multiple"
                SelectedItems="{Binding SelectedMuscleGroups, Mode=TwoWay}"
                HeightRequest="120">

            <!-- Ð¤Ð¾Ð½ CollectionView Ð¿Ð¾Ð´ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð´ Ñ‚ÐµÐ¼Ñƒ -->
            <CollectionView.Background>
                <LinearGradientBrush EndPoint="0,1">
                    <GradientStop Color="{AppThemeBinding Light=#F8F9FA, Dark=#2D2D30}" Offset="0.0" />
                    <GradientStop Color="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}" Offset="1.0" />
                </LinearGradientBrush>
            </CollectionView.Background>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="12">
                        <Label Text="{Binding Name}" 
                       FontSize="16"
                       TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}"
                       VerticalOptions="Center"/>

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup Name="CommonStates">
                                <VisualState Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="BackgroundColor" 
                                        Value="{AppThemeBinding Light=Transparent, Dark=Transparent}" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="Selected">
                                    <VisualState.Setters>
                                        <Setter Property="BackgroundColor" 
                                        Value="{AppThemeBinding Light=#E3F2FD, Dark=#405FC7}" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>



        <Label x:Name="WorkoutDescriptionLabel" />

        <DatePicker x:Name="WorkoutDatePicker" Format="d" Date="{Binding WorkoutDate,Mode=TwoWay}">
            <DatePicker.MinimumDate>1/1/2010</DatePicker.MinimumDate>
            <DatePicker.MaximumDate>1/1/2030</DatePicker.MaximumDate>
        </DatePicker>

        <Editor x:Name="EditorWorkoutDescription"  Placeholder = "Ð²Ð²ÐµÐ´Ð¸ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸"
                FontSize="16" HeightRequest="200"
                Text="{Binding WorkoutDescription, Mode=TwoWay}"
                />
        <Button Text="Ð¡Ð¾Ñ…Ð½Ð°Ð¸Ñ‚ÑŒ" Command="{Binding UpdateWorkoutCommand}"></Button>
        
    </VerticalStackLayout>
    </ScrollView>
</ContentPage>

    
